var Sjl={config:{},style:{core:{},component:{}},core:{template:{},cookie:{},remote:{},event:{},element:{},container:{}},component:{base:{},button:{},input:{},list:{},mask:{},selection:{},window:{}},model:{user:{}},custom:{},_scriptsToLoad:0,_scriptPackages:["core","model","custom"],init:function(){for(var e,n=Sjl._scriptsToLoad=0;n<Sjl._scriptPackages.length;n++)e=Sjl._scriptPackages[n],this.hasOwnProperty(e)&&this._loadPackage(e);for(e in this.component)this.component.hasOwnProperty(e)&&this._loadComponent(e);for(var t in this.style)this.style.hasOwnProperty(t)&&this._loadStyle(t);Sjl._initialized()},_loadPackage:function(e,n,t){if((n=n||this).hasOwnProperty(e))for(var o in n[e])n[e].hasOwnProperty(o)&&this._loadScript(e,o,n,t);else console.warn("package not found: "+e)},_loadStyle:function(e){0!=SjlConfig.loadStyles&&Sjl._createLink(SjlConfig.stylePath+e+".css")},_loadScript:function(e,n,t,o){0!=SjlConfig.loadScripts&&(t[e].hasOwnProperty(n)?(o=o||SjlConfig.libPath,Sjl._createScript(o+e+"/"+n+".js")):console.warn("script not found: "+n))},_loadComponent:function(e){0!=SjlConfig.loadComponents&&(Sjl._createScript(SjlConfig.libPath+"component/"+e+"/controller.js"),"base"!=e&&(Sjl._createScript(SjlConfig.libPath+"component/"+e+"/template.js"),Sjl._createScript(SjlConfig.libPath+"component/"+e+"/events.js")))},_createLink:function(e){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=e,document.head.appendChild(n)},_createScript:function(e){Sjl._scriptsToLoad++;var n=document.createElement("script");n.type="text/javascript",n.src=e,n.onload=Sjl._scriptLoaded,document.head.appendChild(n)},_scriptLoaded:function(e){Sjl._scriptsToLoad--,Sjl._initialized()},_initialized:function(){0==Sjl._scriptsToLoad&&Sjl.initialize()},initialize:function(){var e=Sjl.getCookie("sessionToken");if(Sjl.applySession.constructor==Function&&e&&0<e.length&&Sjl.applySession(e),Sjl.custom.view)for(var n in Sjl.custom.view)Sjl.custom.view.hasOwnProperty(n)&&Sjl.create(Sjl.custom.view[n])}};Sjl.core.container._templates={},Sjl.core.container.init=function(){Sjl.core.element._scopeName="core.container",Sjl.applyConfig(Sjl.core.container,Sjl.core.element),Sjl.findElementById=Sjl.core.container.findElementById,Sjl.findElementByName=Sjl.core.container.findElementByName,Sjl.createContainer=Sjl.core.container.createElement,Sjl.create=Sjl.core.container.create},Sjl.core.container._optimizeConfig=function(e){Sjl.core.element._optimizeConfig(e),e.layout=e.layout||"vertical"},Sjl.core.container._setChildren=function(e,n){for(var t=0;t<e.items.length;t++){var o=e.items[t];o.parent=n.id,o.componentId=n.componentId,o.componentType=n.componentType,o.mainComponentId=n.mainComponentId,"horizontal"===n.layout&&(o.style=o.style||{},o.style.float=o.style.float||"left"),e.items[t]=Sjl.create(o)}},Sjl.core.container.create=function(e,n){var t=Sjl.component[e.type];return t?t.create(e):"container"===e.type?Sjl.createContainer(e,n):Sjl.createElement(e,n)},Sjl.core.container.createElement=function(e,n){var t=Sjl.core.container,o=Sjl.core.element.createElement(e,n);return e.items&&0<e.items.length&&t._setChildren(e,o),o.isContainer=!0,o.findElementById=t.findElementById,o.findElementByName=t.findElementByName,o},Sjl.core.container.findElementById=function(e,n){if(!(n=n||this).hasOwnProperty("items"))return console.warn("cannot find element, because container has not property items: "+n.id),null;for(var t=0;t<n.items.length;t++){var o=n.items[t];if(o.id==e)return o;if(o.isContainer){var l=o.findElementById(e);if(null!=l)return l}}return null},Sjl.core.container.findElementByName=function(e,n){if(!(n=n||this).hasOwnProperty("items"))return console.warn("cannot find element, because container has not property items: "+n.id),null;for(var t=0;t<n.items.length;t++){var o=n.items[t];if(o.name==e)return o;if(o.isContainer){var l=o.findElementByName(e);if(null!=l)return l}}return null},Sjl.core.container.init(),Sjl.core.cookie.init=function(){Sjl.core.cookie._scopeName="core.cookie"},Sjl.setCookie=function(e,n,t,o){var l=e+"="+n;if(t){var i=new Date;i.setTime(i.getTime()+60*t*60*1e3),l+=";"+("expires="+i.toUTCString())}o&&(l+=";path="+o),document.cookie=l},Sjl.getCookie=function(e){var n=document.cookie.split(";");e+="=";for(var t=0;t<n.length;t++){for(var o=n[t];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return""},Sjl.eraseCookie=function(e){document.cookie=e+"=; Max-Age=-99999999;"},Sjl.core.cookie.init(),Sjl.core.element._elements={},Sjl.core.element.init=function(){Sjl.core.element._scopeName="core.element",Sjl.createElement=Sjl.core.element.createElement,Sjl.removeElement=Sjl.core.element.removeElement,Sjl.getElement=Sjl.core.element.getElement,Sjl.showElement=Sjl.core.element.showElement,Sjl.hideElement=Sjl.core.element.hideElement},Sjl.core.element._getNextElementId=function(){var e=Sjl.core.element,n=1;for(var t in e._elements)e._elements.hasOwnProperty(t)&&(n=n<parseInt(t)?parseInt(t):n);return n+1},Sjl.core.element._hasElementId=function(e){var n=Sjl.core.element;for(var t in n._elements)if(e==t)return!0;return!1},Sjl.core.element._addElement=function(e){var n=Sjl.core.element;n._elements.hasOwnProperty(e.id)?console.warn("element already exists in map: "+e.id):n._elements[e.id]=e},Sjl.core.element._removeElement=function(e){var n=Sjl.core.element;n._elements.hasOwnProperty(e.id)?(n._removeElementsWithParentId(e.id),delete n._elements[e.id]):console.warn("element not found in map for remove: "+e.id)},Sjl.core.element._removeElementsWithParentId=function(e){var n=Sjl.core.element;for(var t in n._elements)n._elements.hasOwnProperty(t)&&n._elements[t].id!=e&&n._elements[t].parent===e&&n._removeElement(n._elements[t])},Sjl.core.element._optimizeConfig=function(e){var n=Sjl.core.element;if((e=e||{}).id=e.id||n._getNextElementId(),n._hasElementId(e.id))console.error("element id is already used: "+e.id);else{e.type=e.type||"element",e.name=e.name||e.type;var t="element"!=e.type?e.type:e.name;e.class=e.class||t,-1!=e.class.indexOf("tool-button")&&(e.class="tool-button "+e.class),e.domType=e.domType||"div"}},Sjl.core.element._setStyling=function(e,n){var t=Sjl.core.element;for(var o in e.style)e.style.hasOwnProperty(o)&&n.dom.style.hasOwnProperty(o)&&(n.dom.style[o]=e.style[o].constructor===Number&&t._isMeasureStyle(o)?e.style[o]+"px":e.style[o])},Sjl.core.element._isMeasureStyle=function(e){return"width"==e||"height"==e||"top"==e||"left"==e||-1!=e.indexOf("margin")||-1!=e.indexOf("padding")},Sjl.core.element._addDomEvents=function(e,n,t,o,l){if(o)if(l){var i;if(e)for(i in e)if(e.hasOwnProperty(i)){var a=e[i];if(!l._eventFunctions.hasOwnProperty(a)){console.warn("no function defined for component scope: "+l.toString()+" fn: "+a);continue}o._addDomEvent(t,i,l._eventFunctions[a])}if(n)for(i in n)if(n.hasOwnProperty(i)){for(var r=Sjl,c=n[i].split("."),m=0;m<c.length;m++)"Sjl"!==c[m]&&(r=r[c[m]]);r.constructor===Function&&o._addDomEvent(t,i,r)}}else console.warn("could not add dom events, componentScope undefined for component: "+t.type);else console.warn("could not add dom events, scope undefined for dom: "+t.dom.id)},Sjl.core.element._addDomEvent=function(n,e,t){"click"===e?n.dom.onclick=function(e){t(n,e)}:"change"===e&&(n.dom.onkeyup=function(e){t(n,e)})},Sjl.core.element.createElement=function(e,n){var t=Sjl.component.hasOwnProperty(e.componentType)?Sjl.component[e.componentType]:Sjl.component[e.type],o=Sjl.core.element;o._optimizeConfig(e);var l=e;if(l.dom=document.createElement(e.domType),l.dom.id=e.name+"-"+e.id,l.dom.className=e.class,!0===n&&(l.componentId=l.id,l.componentType=l.type,l.mainComponentId=l.mainComponentId||l.id),e.style&&o._setStyling(e,l),e.text&&(l.dom.innerText=e.text),o._addElement(l),e.parent){var i=o._hasElementId(e.parent)?o.getElement(e.parent):null,a=i?i.dom:null,r="body"===e.parent?top.document.body:a;r&&r.appendChild(l.dom)}return t&&o._addDomEvents(e.events,e.callbacks,l,o,t),l},Sjl.core.element.getElement=function(e){var n=Sjl.core.element;return n._elements.hasOwnProperty(e)?n._elements[e]:(console.warn("element not found in map for get: "+e),null)},Sjl.core.element.removeElement=function(e){var n=Sjl.core.element,t=n.getElement(e);null!=t?(t.dom.parentNode&&t.dom.parentNode.removeChild(t.dom),n._removeElement(t)):console.warn("element not found for remove: "+e)},Sjl.core.element.showElement=function(e){var n=Sjl.core.element.getElement(e);null!=n?n.dom.style.display="block":console.warn("element not found to show: "+e)},Sjl.core.element.hideElement=function(e){var n=Sjl.core.element.getElement(e);null!=n?n.dom.style.display="none":console.warn("element not found to hide: "+e)},Sjl.core.element.init(),Sjl._eventListeners={},Sjl.core.event.init=function(){Sjl.core.event._scopeName="core.event"},Sjl.listen=function(e,n,t){(t=t||Sjl)._eventListeners.hasOwnProperty(e)?console.error("listeners are already defined: "+e):t._eventListeners[e]=n},Sjl.fire=function(e,n,t){(t=t||Sjl)._eventListeners.hasOwnProperty(e)&&t._eventListeners[e](n,t)},Sjl.core.event.init(),Sjl.core.remote.init=function(){Sjl.core.remote._scopeName="core.remote"},Sjl.request=function(e){if(e&&e.resource){e.method=e.method||"GET";var n=Sjl.getCookie("sessionToken"),t=new XMLHttpRequest;t.onreadystatechange=function(){Sjl.core.remote._requestReadyStateChange(this,e)},t.open(e.method,SjlConfig.remotePath+e.resource,!0),t.setRequestHeader("Content-type","application/json"),!n&&e.authentication&&(n=btoa(e.authentication.name+":"+e.authentication.password)),n&&(e.sessionToken=n,t.withCredentials=!0,t.setRequestHeader("Authorization","Basic "+n)),e.loadingElement=Sjl.createMask(e.loadingText?{title:e.loadingText}:{}),t.send()}else console.warn("no options defined for request.")},Sjl.core.remote._requestReadyStateChange=function(e,n){if(4==e.readyState){var t=null;if(0==e.status.toString().indexOf("2"))try{t=JSON.parse(e.responseText)}catch(e){t=null,console.warn("Could not parse response: "+e)}var o={request:e,status:e.status,value:t};n.callback&&n.callback(o,n),Sjl.removeMask(n.loadingElement.id)}},Sjl.core.remote.init(),Sjl.core.template.init=function(){Sjl.core.element._scopeName="core.template",Sjl.applyCustom=Sjl.core.template.applyCustom,Sjl.applyConfig=Sjl.core.template.applyConfig,Sjl.generateTemplateConfig=Sjl.core.template.generateTemplateConfig},Sjl.core.template.applyCustom=function(e,n){if(n.templateConfig){if(n.extendComponent){if(!n.templateName)return void console.error("cannot create custom component, because no template-name is defined.");n.extendComponent._templates[n.templateName]=n.templateConfig}return Sjl.core.template.applyConfig(e,n)}console.error("cannot create custom, because no template-config is defined.")},Sjl.core.template.applyConfig=function(e,n){var t=Sjl.core.template;if(n&&e){if(n.constructor===e.constructor){if(n.constructor===Array)for(var o=0;o<n.length;o++)-1==e.indexOf(n[o])&&e.push(t.applyConfig({},n[o]));if(n.constructor===Object)for(var l in n)n.hasOwnProperty(l)&&!e.hasOwnProperty(l)?e[l]=n[l]:e.hasOwnProperty(l)&&e[l].constructor===Object&&(e[l]=t.applyConfig(e[l],n[l]));return e}console.error("cannot apply config, because both configs are not of the same type: "+e.constructor.name+" - "+n.constructor.name)}},Sjl.core.template.generateTemplateConfig=function(e,n){for(var t=Sjl.core.template,o=t._getTemplateConfig(e,n),l=JSON.stringify(o),i=t._getParameters(l),a=0;a<i.length;a++)n.hasOwnProperty(i[a])&&(l=n[i[a]].constructor==Number?l.replace('"{{'+i[a]+'}}"',n[i[a]]):l.replace("{{"+i[a]+"}}",n[i[a]]));return o=JSON.parse(l),t.applyConfig(o,n),o},Sjl.core.template._getTemplateConfig=function(e,n){return e._templates.hasOwnProperty(n.templateName)?e._templates[n.templateName]:e._templates.default},Sjl.core.template._getParameters=function(e){for(var n=[],t=e.indexOf("{{"),o=e.substr(t+2,e.length);-1!=t;)n.push(o.substring(0,o.indexOf("}}"))),t=o.indexOf("{{"),o=o.substr(t+2,o.length);return n},Sjl.core.template.init(),Sjl.component.base._templates={},Sjl.component.base.init=function(){Sjl.core.element._scopeName="component.base"},Sjl.component.base._optimizeConfig=function(e){(e=e||{}).parent=e.parent||"body",e.hidden=e.hidden||!1,e.templateName=e.templateName||"default"},Sjl.component.base.create=function(e,n){(n=n||Sjl.component.base)._optimizeConfig(e);var t=Sjl.createContainer(Sjl.generateTemplateConfig(n,e),!0);return 1!=e.hidden&&Sjl.showElement(t.id),t},Sjl.component.base.init(),Sjl.component.button._eventFunctions={},Sjl.component.button._templates={},Sjl.component.button.init=function(){Sjl.core.element._scopeName="component.button",Sjl.applyConfig(Sjl.component.button,Sjl.component.base)},Sjl.component.button._optimizeConfig=function(e){Sjl.component.base._optimizeConfig(e),e.type="input",e.height=e.height||30,e.callbacks=e.callbacks||{}},Sjl.component.button.create=function(e,n){return n=n||Sjl.component.button,Sjl.component.base.create(e,n)},Sjl.component.button.init(),Sjl.component.button._templates.default={type:"button",parent:"{{parent}}",style:{width:"{{width}}",height:"{{height}}"}},Sjl.component.input._eventFunctions={},Sjl.component.input._templates={},Sjl.component.input.init=function(){Sjl.core.element._scopeName="component.input",Sjl.applyConfig(Sjl.component.input,Sjl.component.base)},Sjl.component.input._optimizeConfig=function(e){Sjl.component.base._optimizeConfig(e),e.type="input",e.width=e.width||"100%",e.height=e.height||30},Sjl.component.input.create=function(e,n){n=n||Sjl.component.input;var t=Sjl.component.base.create(e,n),o=t.findElementByName("label"),l=t.findElementByName("value");return e.label&&o&&(o.dom.innerText=e.label),e.value&&l&&(l.dom.innerText=e.value),e.inputType&&l&&(l.dom.type=e.inputType),t},Sjl.component.input.init(),Sjl.component.input._eventFunctions.changeValue=function(e,n){e.value=e.dom.value;var t=Sjl.getElement(e.componentId);t&&(t.value=e.value)},Sjl.component.input._templates.default={type:"input",parent:"{{parent}}",style:{width:"{{width}}",height:"{{height}}","margin-bottom":"10px"},layout:"horizontal",items:[{name:"label",style:{width:"40%"}},{name:"value",domType:"input",inputType:"text",style:{width:"60%","border-bottom":"1px solid"},events:{change:"changeValue"}}]},Sjl.component.list._eventFunctions={},Sjl.component.list._templates={},Sjl.component.list.init=function(){Sjl.core.element._scopeName="component.list",Sjl.applyConfig(Sjl.component.list,Sjl.component.base)},Sjl.component.list._optimizeConfig=function(e){Sjl.component.base._optimizeConfig(e),e.type="list",e.width=e.width||200,e.height=e.height||100},Sjl.component.list.create=function(e,n){return n=n||Sjl.component.list,Sjl.component.base.create(e,n)},Sjl.component.list.init(),Sjl.component.list._eventFunctions.clickList=function(e,n){},Sjl.component.list._templates.default={type:"list",parent:"{{parent}}",style:{width:"{{width}}",height:"{{height}}"},events:{click:"clickList"},items:[]},Sjl.component.mask._eventFunctions={},Sjl.component.mask._masks={},Sjl.component.mask._templates={},Sjl.component.mask.init=function(){Sjl.core.element._scopeName="component.mask",Sjl.applyConfig(Sjl.component.window,Sjl.component.base),Sjl.createMask=Sjl.component.mask.create,Sjl.removeMask=Sjl.component.mask.remove},Sjl.component.mask._optimizeConfig=function(e){Sjl.component.base._optimizeConfig(e),e.type="mask",e.width=e.width||"100%",e.height=e.height||"100%",e.title=e.title||"Loading"},Sjl.component.mask.create=function(e,n){n=n||Sjl.component.mask;var t=Sjl.component.base.create(e,n);return n._masks[t.id]=t},Sjl.component.mask.remove=function(e){var n=Sjl.component.mask;n._masks.hasOwnProperty(e)||console.error("no mask found to remove: "+e),Sjl.removeElement(e),delete n._masks[e]},Sjl.component.mask.init(),Sjl.component.mask._templates.default={type:"mask",name:"mask",items:[{name:"mask-icon"},{name:"mask-text",text:"{{title}}"}]},Sjl.component.selection._eventFunctions={},Sjl.component.selection._templates={},Sjl.component.selection.init=function(){Sjl.core.element._scopeName="component.selection",Sjl.applyConfig(Sjl.component.selection,Sjl.component.input)},Sjl.component.selection._optimizeConfig=function(e){Sjl.component.input._optimizeConfig(e),e.type="selection",e.readOnly=e.readOnly||!1},Sjl.component.selection.create=function(e,n){n=n||Sjl.component.selection;var t=Sjl.component.input.create(e,n),o=t.findElementByName("value");return!0===e.readOnly&&o&&(o.dom.readOnly=e.readOnly),t},Sjl.component.selection.init(),Sjl.component.selection._eventFunctions.clickExpand=function(e,n){},Sjl.component.selection._templates.default={type:"selection",parent:"{{parent}}",style:{width:"{{width}}",height:"{{height}}"},layout:"horizontal",items:[{name:"label",style:{width:"40%"}},{name:"value",domType:"input",inputType:"text",style:{width:"calc(60% - 30px)","border-bottom":"1px solid"}},{name:"tool-button-expand",style:{"border-bottom":"1px solid"},events:{click:"clickExpand"}}]},Sjl.component.window._eventFunctions={},Sjl.component.window._templates={},Sjl.component.window._windows={},Sjl.component.window.init=function(){Sjl.core.element._scopeName="component.window",Sjl.applyConfig(Sjl.component.window,Sjl.component.base),Sjl.createWindow=Sjl.component.window.create,Sjl.getWindow=Sjl.component.window.getWindow,Sjl.removeWindow=Sjl.component.window.removeWindow,Sjl.centerWindow=Sjl.component.window.centerWindow},Sjl.component.window._optimizeConfig=function(e){Sjl.component.base._optimizeConfig(e),e.type="window",e.width=e.width||400,e.height=e.height||400},Sjl.component.window.create=function(e,n){n=n||Sjl.component.window;var t,o=Sjl.component.base.create(e,n),l=Sjl.applyConfig([],e.items)||[],i=Sjl.applyConfig([],e.buttons)||[];for(t=0;t<l.length;t++){var a=l[t],r=o.findElementByName("window-content");a.parent=null==r?null:r.id,Sjl.create(a)}for(t=0;t<i.length;t++){var c=i[t];c.style=c.style||{},c.style.float="right";var m=o.findElementByName("window-buttons");c.parent=null==m?null:m.id,Sjl.create(c)}return n._windows[o.id]=o,n.centerWindow(o),o},Sjl.component.window.getWindow=function(e){return Sjl.component.window._windows.hasOwnProperty(e)?this._windows[e]:(console.error("no window found to get: "+e),null)},Sjl.component.window.removeWindow=function(e){var n=Sjl.component.window;n._windows.hasOwnProperty(e)||console.error("no window found to remove: "+e),Sjl.removeElement(e),delete n._windows[e]},Sjl.component.window.centerWindow=function(e){var n=Sjl.component.window;(e="object"==typeof e?e:n.getWindow(e)).dom.style.left=(top.document.body.offsetWidth-e.style.width)/2+"px",e.dom.style.top=(top.document.body.offsetHeight-e.style.height)/2+"px"},Sjl.component.window.init(),Sjl.component.window._eventFunctions.clickClose=function(e,n){Sjl.removeWindow(e.componentId)},Sjl.component.window._eventFunctions.clickLogin=function(e,n){var t=Sjl.getElement(e.mainComponentId),o=Sjl.findElementByName("input-name",t),l=Sjl.findElementByName("input-password",t);if(o&&o.value&&l&&l.value){var i={method:"GET",resource:"users/login",callback:Sjl.component.window._eventFunctions.loginCallback,authentication:{name:o.value,password:l.value},mainComponentId:e.mainComponentId};Sjl.request(i)}else console.error("no login values found.")},Sjl.component.window._eventFunctions.clickRegister=function(e,n){},Sjl.component.window._eventFunctions.loginCallback=function(e,n){200==e.status?(Sjl.setCookie("sessionToken",n.sessionToken,4),Sjl.removeWindow(n.mainComponentId),Sjl.fire("afterLogin",e,n)):console.error("login failed.")},Sjl.component.window._templates.default={type:"window",parent:"{{parent}}",style:{width:"{{width}}",height:"{{height}}"},items:[{type:"container",name:"window-header",class:"window-header",layout:"horizontal",items:[{name:"window-header-title",class:"title",text:"{{title}}"},{name:"window-header-close",class:"tool-button-close",style:{float:"right"},events:{click:"clickClose"}}]},{type:"container",name:"window-content",class:"window-content"},{type:"container",name:"window-buttons",class:"window-buttons",layout:"horizontal"}]},Sjl.component.window._templates.login={type:"window",name:"login",parent:"{{parent}}",style:{width:"{{width}}",height:"{{height}}"},items:[{type:"container",name:"window-header",class:"window-header",layout:"horizontal",items:[{name:"window-header-title",class:"title",text:"{{title}}"},{name:"window-header-close",class:"tool-button-close",style:{float:"right"},events:{click:"clickClose"}}]},{type:"container",name:"window-content",class:"window-content",items:[{type:"input",label:"Name",name:"input-name"},{type:"input",label:"Password",name:"input-password",inputType:"password"}]},{type:"container",name:"window-buttons",class:"window-buttons",layout:"horizontal",items:[{type:"button",text:"Register",style:{float:"right"},events:{click:"clickRegister"}},{type:"button",text:"Login",style:{float:"right"},events:{click:"clickLogin"}}]}]};